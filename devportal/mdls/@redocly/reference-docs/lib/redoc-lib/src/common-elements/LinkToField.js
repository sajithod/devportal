"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShareLinkToField=exports.LinkToField=void 0;var templateObject_1,tslib_1=require("tslib"),react_1=(0,tslib_1.__importDefault)(require("react")),components_1=require("../components"),styled_components_1=(0,tslib_1.__importDefault)(require("../styled-components")),constants_1=require("../services/constants"),linkify_1=require("./linkify"),helpers_1=require("../../../services/history/helpers"),icons_1=require("./icons"),LinkToField=function(e){var n,i,t,o=react_1.default.useContext(components_1.StoreContext),l=react_1.default.useState(!1),r=l[0],s=l[1],a=(null==o?void 0:o.menu.history.linkForId(null===(i=e.field.deps.operation)||void 0===i?void 0:i.id))||"",c=(0,helpers_1.constructFieldDeepFragment)(e.field),u=o&&c?o.menu.history.generateDeepLink(c,a):null,d=o?((n={})[constants_1.SECTION_ATTR]=(null===(t=e.field.deps.operation)||void 0===t?void 0:t.id)+o.options.deepLinkPrefix+c,n.id=u&&u.split("#")[1]||void 0,n):null;return react_1.default.useEffect((function(){if(o&&d)return s(o.menu.history.currentId===d[constants_1.SECTION_ATTR]),o.menu.history.subscribe((function(e){s(e===d[constants_1.SECTION_ATTR])}))}),[null==o?void 0:o.menu.history,null==d?void 0:d[constants_1.SECTION_ATTR]]),c&&o&&u?react_1.default.createElement("a",(0,tslib_1.__assign)({className:e.className+(r?" active":""),href:u,onClick:function(e){return function(e,n,i){n.defaultPrevented||(0,linkify_1.userIsForcingNavigation)(n)||(n.preventDefault(),e.replaceForField(i))}(null==o?void 0:o.menu.history,e,u),e.stopPropagation(),e.preventDefault(),o.options.onDeepLinkClick&&o.options.onDeepLinkClick(u),!1}},d),react_1.default.createElement(icons_1.LinkIcon,null),e.children):react_1.default.createElement(react_1.default.Fragment,null,e.children||null)};exports.LinkToField=LinkToField,exports.ShareLinkToField=(0,styled_components_1.default)(exports.LinkToField)(templateObject_1||(templateObject_1=(0,tslib_1.__makeTemplateObject)(["\n  ","\n\n  & {\n    position: absolute;\n    padding-right: 4px;\n    transform: translateX(-90%);\n\n    .field-name:hover & ",", &:hover & "," {\n      visibility: visible;\n    }\n  }\n\n  &.active "," {\n    visibility: visible;\n  }\n"],["\n  ","\n\n  & {\n    position: absolute;\n    padding-right: 4px;\n    transform: translateX(-90%);\n\n    .field-name:hover & ",", &:hover & "," {\n      visibility: visible;\n    }\n  }\n\n  &.active "," {\n    visibility: visible;\n  }\n"])),(0,linkify_1.linkifyMixin)("&","13px"),icons_1.LinkIcon,icons_1.LinkIcon,icons_1.LinkIcon);
//# sourceMappingURL=LinkToField.js.map