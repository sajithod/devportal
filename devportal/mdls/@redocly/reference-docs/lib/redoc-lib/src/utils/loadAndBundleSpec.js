"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertSwagger2OpenAPI=exports.createParsedDocument=exports.loadAndBundleDefinition=void 0;var tslib_1=require("tslib"),bundle_1=require("@redocly/openapi-core/lib/bundle"),config_1=require("@redocly/openapi-core/lib/config/config"),swagger2openapi_1=require("swagger2openapi"),dom_1=require("./dom");function loadAndBundleDefinition(e){return(0,tslib_1.__awaiter)(this,void 0,void 0,(function(){var n,o,r;return(0,tslib_1.__generator)(this,(function(t){switch(t.label){case 0:return n=new config_1.Config({}),o={config:n,base:dom_1.IS_BROWSER?window.location.href:process.cwd()},dom_1.IS_BROWSER&&(n.resolve.http.customFetch=global.fetch),"object"==typeof e&&null!==e?o.doc=createParsedDocument(e):o.ref=e,[4,(0,bundle_1.bundle)(o)];case 1:return[2,void 0!==(r=t.sent().bundle.parsed).swagger?convertSwagger2OpenAPI(r):r]}}))}))}function createParsedDocument(e){return{source:{absoluteRef:""},parsed:e}}function convertSwagger2OpenAPI(e){return console.warn("[ReDoc Compatibility mode]: Converting OpenAPI 2.0 to OpenAPI 3.0"),e.paths||(e.paths={}),new Promise((function(n,o){return(0,swagger2openapi_1.convertObj)(e,{patch:!0,warnOnly:!0,text:"{}",anchors:!0},(function(e,r){if(e)return o(e);n(null==r?void 0:r.openapi)}))}))}exports.loadAndBundleDefinition=loadAndBundleDefinition,exports.createParsedDocument=createParsedDocument,exports.convertSwagger2OpenAPI=convertSwagger2OpenAPI;
//# sourceMappingURL=loadAndBundleSpec.js.map