"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OpenIDConnect=void 0;var tslib_1=require("tslib"),React=(0,tslib_1.__importStar)(require("react")),redoc_lib_1=require("../../redoc-lib"),OpenIDConnect_1=require("../../services/OpenIDConnect"),OAuth2Flow_1=require("./OAuth2Flow"),LinearProgress_1=require("../common/LinearProgress"),form_1=require("../common/form");function OpenIDConnect(e){var t,r=this,n=e.scheme,o=e.defaultValues,a=React.useState({}),l=a[0],c=a[1],i=React.useState(),s=i[0],u=i[1],m=React.useState(!1),p=m[0],d=m[1];React.useEffect((function(){_(n.openIdConnectUrl)}),[n.openIdConnectUrl]);var _=function(e){return(0,tslib_1.__awaiter)(r,void 0,void 0,(function(){var t,r;return(0,tslib_1.__generator)(this,(function(n){switch(n.label){case 0:d(!0),u(""),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,OpenIDConnect_1.discoverOpenIDConnect)(e)];case 2:return t=n.sent(),c(t),[3,4];case 3:return r=n.sent(),u(r.message),[3,4];case 4:return d(!1),[2]}}))}))};return React.createElement("div",null,p?React.createElement("div",null,React.createElement("div",null,"Fetching OpenID Connect metadata..."),React.createElement(LinearProgress_1.LinearProgress,null)):React.createElement("div",null,s?React.createElement(form_1.FormError,null,s):(null===(t=null==l?void 0:l.response_types_supported)||void 0===t?void 0:t.includes("token"))?React.createElement(React.Fragment,null,React.createElement(FlowName,null,"OAuth2 Implicit Flow"),React.createElement(OAuth2Flow_1.OAuth2Flow,{key:e.id,authorizationUrl:l.authorization_endpoint,authCorsProxyUrl:e.authCorsProxyUrl,scopes:l.scopes_supported,server:e.server,id:e.id,form:e.form,formApi:e.formApi,clientId:e.clientId,flow:"implicit",defaultValues:o})):React.createElement("div",null,"Unsupported flow")))}exports.OpenIDConnect=OpenIDConnect;var templateObject_1,FlowName=redoc_lib_1.styled.div(templateObject_1||(templateObject_1=(0,tslib_1.__makeTemplateObject)(["\n  margin-top: 5px;\n  margin-bottom: 10px;\n"],["\n  margin-top: 5px;\n  margin-bottom: 10px;\n"])));
//# sourceMappingURL=OpenIDConnect.js.map