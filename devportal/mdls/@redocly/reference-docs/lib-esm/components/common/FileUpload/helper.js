import{__awaiter,__generator}from"tslib";import{DefinitionTypes,FileUploadFormats}from"../../../models";var FILE_UPLOAD_FORMATS=Object.values(FileUploadFormats),FILE_UPLOAD_MIME_TYPES=["application/octet-stream","application/pdf","application/gzip","application/zip"],COMMON_FILE_UPLOAD_PREFIXES=["image/","audio/","video/"];export function mimeTypeToAccept(e){if(COMMON_FILE_UPLOAD_PREFIXES.some((function(t){return e.startsWith(t)})))return e}export function isFileUploadMime(e){return!!FILE_UPLOAD_MIME_TYPES.includes(e)||COMMON_FILE_UPLOAD_PREFIXES.some((function(t){return e.startsWith(t)}))}export function isMultipartFileUploadProperty(e){var t="array"===e.type?e.items:e;if(!t||!t.type||"any"===(null==t?void 0:t.type))return!0;var i=t.contentMediaType||"",n=t.format||t.contentEncoding||(isFileUploadMime(i)?"binary":"");return t.type===DefinitionTypes.STRING&&FILE_UPLOAD_FORMATS.includes(n)}export function isRootFileUpload(e,t){if(!e||!e.type||"any"===e.type)return isFileUploadMime(t);var i=e.format||e.contentEncoding||"";return e.type===DefinitionTypes.STRING&&FILE_UPLOAD_FORMATS.includes(i)}export function fileToBase64(e){return new Promise((function(t,i){var n=new FileReader;n.onload=function(){var e=n.result.replace(/data:.*\/.*;base64,/g,"");t(e)},n.onerror=function(){return i(n.error)},n.readAsDataURL(e)}))}export function getIsBase64(e){return[e.format,e.contentEncoding,e.contentMediaType].includes(FileUploadFormats.BASE64)}export function getFileToUpload(e,t){return __awaiter(this,void 0,void 0,(function(){var i,n,r=this;return __generator(this,(function(o){switch(o.label){case 0:return i=Object.values(e),n=1===i.length?i[0]:i,t.type===DefinitionTypes.STRING&&getIsBase64(t)?[4,fileToBase64(i[0])]:[3,2];case 1:return n=o.sent(),[3,5];case 2:return t.type===DefinitionTypes.ARRAY&&t.items?getIsBase64(t.items)?[4,Promise.all(i.map((function(e){return __awaiter(r,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,fileToBase64(e)];case 1:return[2,t.sent()]}}))}))})))]:[3,4]:[3,5];case 3:return n=o.sent(),[3,5];case 4:n=i,o.label=5;case 5:return[2,n]}}))}))}
//# sourceMappingURL=helper.js.map