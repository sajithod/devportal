import{isStateValid,genericErrorMessage}from"./helpers";export function handleOAuth2Redirect(e){var r;if(!(r=/code|token|error/.test(window.location.hash)?window.location.hash.substring(1):location.search.substring(1)))throw console.error("No query string in OAuth 2 redirect URL"),new Error(genericErrorMessage);var t=new URLSearchParams(r),o=t.get("access_token"),i=t.get("code"),a=t.get("token_type"),n=t.get("expires_in"),s=t.get("state"),c=t.get("error"),u=t.get("error_description")||genericErrorMessage;if(c)throw new Error(u);if(!isStateValid(s,null==e?void 0:e.state))throw new Error("Outdated OAuth2 state");if("implicit"===(null==e?void 0:e.flow)){if(!o)throw new Error('Your OAuth2 authentication service provider redirected you without an "access_token".\nPlease, try again or make sure your OAuth2 settings are correct.');if(!a)throw new Error('Your OAuth2 authentication service provider redirected you without a "token_type".\nPlease, try again or make sure your OAuth2 settings are correct.');null==e||e.successCallback({access_token:o,token_type:a,expires_in:n,auth_code:""})}if("authorizationCode"===(null==e?void 0:e.flow)){if(!i)throw new Error('Your OAuth2 authentication service provider redirected you without authorization "code".\nPlease, try again or make sure your OAuth2 settings are correct.');null==e||e.successCallback({auth_code:i,access_token:"",token_type:"bearer"})}}
//# sourceMappingURL=oauth2-redirect-handler.js.map