import{__assign,__makeTemplateObject}from"tslib";import React from"react";import{StoreContext}from"../components";import styled from"../styled-components";import{SECTION_ATTR}from"../services/constants";import{linkifyMixin,userIsForcingNavigation}from"./linkify";import{constructFieldDeepFragment}from"../../../services/history/helpers";import{LinkIcon}from"./icons";export var LinkToField=function(e){var n,i,t,o=React.useContext(StoreContext),r=React.useState(!1),l=r[0],a=r[1],s=(null==o?void 0:o.menu.history.linkForId(null===(i=e.field.deps.operation)||void 0===i?void 0:i.id))||"",c=constructFieldDeepFragment(e.field),p=o&&c?o.menu.history.generateDeepLink(c,s):null,m=o?((n={})[SECTION_ATTR]=(null===(t=e.field.deps.operation)||void 0===t?void 0:t.id)+o.options.deepLinkPrefix+c,n.id=p&&p.split("#")[1]||void 0,n):null;return React.useEffect((function(){if(o&&m)return a(o.menu.history.currentId===m[SECTION_ATTR]),o.menu.history.subscribe((function(e){a(e===m[SECTION_ATTR])}))}),[null==o?void 0:o.menu.history,null==m?void 0:m[SECTION_ATTR]]),c&&o&&p?React.createElement("a",__assign({className:e.className+(l?" active":""),href:p,onClick:function(e){return function(e,n,i){n.defaultPrevented||userIsForcingNavigation(n)||(n.preventDefault(),e.replaceForField(i))}(null==o?void 0:o.menu.history,e,p),e.stopPropagation(),e.preventDefault(),o.options.onDeepLinkClick&&o.options.onDeepLinkClick(p),!1}},m),React.createElement(LinkIcon,null),e.children):React.createElement(React.Fragment,null,e.children||null)};export var ShareLinkToField=styled(LinkToField)(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  ","\n\n  & {\n    position: absolute;\n    padding-right: 4px;\n    transform: translateX(-90%);\n\n    .field-name:hover & ",", &:hover & "," {\n      visibility: visible;\n    }\n  }\n\n  &.active "," {\n    visibility: visible;\n  }\n"],["\n  ","\n\n  & {\n    position: absolute;\n    padding-right: 4px;\n    transform: translateX(-90%);\n\n    .field-name:hover & ",", &:hover & "," {\n      visibility: visible;\n    }\n  }\n\n  &.active "," {\n    visibility: visible;\n  }\n"])),linkifyMixin("&","13px"),LinkIcon,LinkIcon,LinkIcon);var templateObject_1;
//# sourceMappingURL=LinkToField.js.map