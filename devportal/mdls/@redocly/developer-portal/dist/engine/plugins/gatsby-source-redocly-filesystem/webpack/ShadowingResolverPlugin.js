const fs=require("fs"),path=require("path"),{slash}=require("gatsby-core-utils"),USER_COMPONENTS_FOLDER=path.resolve(__dirname,"../../../src/components/UserComponents"),OVERRIDES_FOLDER="_override",USER_COMPONENTS={NavBar:!0,Footer:!0,MenuItem:!0,Menu:!0,SearchInput:!0,SearchResults:!0,ApiReferenceInfo:!0,"layouts/Sidebar":!0,"layouts/Markdown":!0,App:!0};let i=0;exports.ShadowingResolverPlugin=class{constructor(a){this.componentsRoot=path.join(a,OVERRIDES_FOLDER)}apply(a){a.hooks.describedResolve.tapAsync(`RedoclyComponentShadowingResolverPlugin`,(b,c,d)=>{if(b.processed)return d();if(!b.path)return d();const e=path.resolve(b.path,b.request||"");if(!e.startsWith(USER_COMPONENTS_FOLDER))return d();const f=slash(path.relative(USER_COMPONENTS_FOLDER,e));if(!USER_COMPONENTS[f])return d();if(slash(b.context.issuer).endsWith("engine/src/ui/index.ts")||slash(b.context.issuer).endsWith("engine/src/ui/index.js"))return d();if(b.context.issuer.startsWith(this.componentsRoot))return d();const g=path.resolve(this.componentsRoot,f);return fileExists(g+".jsx")||fileExists(g+".tsx")?a.doResolve(a.hooks.describedResolve,{...b,request:g,processed:!0},null,{},d):d()})}};function fileExists(a){try{return fs.lstatSync(a).isFile()}catch(a){return!1}}